<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Kickstart text classification with GPT-3, part 2</title><style>html body{font-family:source sans pro,sans-serif;background-color:#fff;font-weight:200}:root{--accent:#9c27b0;--border-width:5px}</style><link rel=stylesheet href=https://antopolskiy.github.io/css/main.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Source%20Sans%20Pro"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin=anonymous><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/json.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/bash.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/toml.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/go.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/java.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/html.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/css.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/sql.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/cpp.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/c.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/dockerfile.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/makefile.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/nginx.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/shell.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/swift.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/typescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/xml.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/kotlin.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/rust.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/powershell.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/ruby.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/scala.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/haskell.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/perl.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/lua.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/matlab.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/scheme.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/clojure.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/erlang.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/elixir.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/fortran.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/lisp.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/pascal.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/prolog.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/vhdl.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/verilog.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/coffeescript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/diff.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/django.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/jinja.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/latex.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/markdown.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/nginx.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/nginxconf.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/protobuf.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/toml.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/vim.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/x86asm.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js></script><script>hljs.initHighlightingOnLoad()</script><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script><script>$(document).on("click",function(){$(".collapse").collapse("hide")})</script><meta name=generator content="Hugo 0.124.1"><script type=text/javascript async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></head><body><nav class="navbar navbar-default navbar-fixed-top"><div class=container><div class=navbar-header><a class="navbar-brand visible-xs" href=#>Kickstart text classification with GPT-3, part 2</a>
<button class=navbar-toggle data-target=.navbar-collapse data-toggle=collapse>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li><a href=/>Home</a></li><li><a href=/post/>Posts</a></li></ul><ul class="nav navbar-nav navbar-right"><li class=navbar-icon><a href=mailto:s.antopolsky@gmail.com><i class="fas fa-envelope"></i></a></li><li class=navbar-icon><a href=https://github.com/antopolskiy/><i class="fab fa-github"></i></a></li><li class=navbar-icon><a href=https://twitter.com/antopolskiy/><i class="fab fa-twitter"></i></a></li><li class=navbar-icon><a href=https://www.linkedin.com/in/antop/><i class="fab fa-linkedin"></i></a></li><li class=navbar-icon><a href=https://stackoverflow.com/users/3033945/sergey-antopolskiy><i class="fab fa-stack-overflow"></i></a></li></ul></div></div></nav><main><div class=content><h2>Kickstart text classification with GPT-3, part 2</h2><h5>Pubished: October 22, 2022</h5><a href=https://antopolskiy.github.io/tags/ml><kbd class=item-tag>ml</kbd></a>
<a href=https://antopolskiy.github.io/tags/nlp><kbd class=item-tag>nlp</kbd></a>
<a href=https://antopolskiy.github.io/tags/gpt3><kbd class=item-tag>gpt3</kbd></a></div><div align=start class=content><h2 id=where-we-stopped>Where we stopped</h2><p>In the <a href=https://antopolskiy.github.io/post/gpt3_1/>previous part</a> we finished with the desire to get predictions for multiple samples and multiple categories. We will do it here using a Markdown table format.</p><h2 id=what-is-markdown>What is Markdown?</h2><blockquote><p>Markdown is a lightweight markup language that you can use to add formatting elements to plaintext text documents. Created by <a href=https://daringfireball.net/projects/markdown/>John Gruber</a> in 2004, Markdown is now one of the world’s most popular markup languages.</p></blockquote><p>Basically, Markdown is a way to specify formatting in a plain text document, using special symbols. E.g. to make bold text, you&rsquo;d write two asterisks before and after, like so: <code>**bold**</code>. The platforms which support markdown will automatically render this as <strong>bold</strong> text.</p><h2 id=how-markdown-tables-are-written-in-plain-text>How Markdown tables are written in plain text</h2><p>There is a way to create tables in Markdown, which, in the most basic version, looks like this:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>| column 1 | column 2 | column 3 |
</span></span><span style=display:flex><span>| --- | --- | --- |
</span></span><span style=display:flex><span>| 1 | 2 | 3 |
</span></span><span style=display:flex><span>| 4 | 2 | 3 |
</span></span></code></pre></div><p>And it will be rendered like so:</p><table class="table table-striped table-bordered"><thead><tr><th>column 1</th><th>column 2</th><th>column 3</th></tr></thead><tbody><tr><td>1</td><td>2</td><td>3</td></tr><tr><td>4</td><td>2</td><td>3</td></tr></tbody></table><p>Why is this useful for us? Because GPT-3 has seen a lot of Markdown. And once we hint at the fact that what it is completing is a Markdown document, it will stick to this format pretty well. This will give us a stable and structured output, which we can easily parse.</p><p>So the main idea of the approach is that we will prompt GPT-3 in such a way that it will create a table of samples and labels. How exactly?</p><h2 id=organizing-a-response-as-a-markdown-table>Organizing a response as a Markdown table</h2><p>Here is the basic breakdown:</p><ol><li>Provide the text to be classified as a list of samples.</li><li>Each sample needs to have some kind of identifier, which will be included in the table (in our example of Steam games classification, it can be the name of the game).</li><li>Create the first two rows of Markdown table: column titles and the separator.</li><li>Let GPT-3 do the rest of the magic.</li></ol><p>Here are a couple of examples of prompts with GPT-3 completion:</p><div style="border:.5px solid #d0d1d8;border-radius:3px;color:#4a4c52;padding:15px;font-family:helveticaneue-light,sans-serif;margin-top:2em;margin-bottom:2em;font-size:18px;height:100%"># List of games<br><br>Name: PlanetSide 2<br>Description: PlanetSide 2 is an all-out planetary war, where thousands of players battle as one across enormous continents. Utilize infantry, ground and air vehicles, and teamwork to destroy your enemies in this revolutionary first-person shooter on a massive scale.<br><br>Name: SMITE®<br>Description: Join over 30 million SMITE players! Wield Thor’s hammer, transform your foes to stone as Medusa, or choose from the other 100+ mythological icons. You’ll always have more to discover with free regular updates. Enter the Battleground of the Gods!<br><br>Name: Grand Theft Auto IV<br>Description: What does the American dream mean today? For Niko Bellic fresh off the boat from Europe, it is the hope he can escape from his past. For his cousin, Roman, it is the vision that together they can find fortune in Liberty City, gateway to the land of opportunity.<br><br>Name: Chivalry: Medieval Warfare<br>Description: Besiege castles and raid villages in Chivalry: Medieval Warfare, a fast-paced medieval first person slasher with a focus on multiplayer battles<br><br>Name: Darkest Dungeon®<br>Description: Darkest Dungeon is a challenging gothic roguelike turn-based RPG about the psychological stresses of adventuring. Recruit, train, and lead a team of flawed heroes against unimaginable horrors, stress, famine, disease, and the ever-encroaching dark. Can you keep your heroes together when all hope is lost?<br><br># Table of games and their genres<br><br>| Name | Action | RPG | Strategy | Simulation | Puzzle | Casual | Adventure | Platformer |<br>| --- | --- | --- | --- | --- | --- | --- | --- | --- |<span style=background-color:#b9eebc>
&nbsp;<br>| PlanetSide 2 | Yes | No | Yes | No | No | No | No | No |<br>| SMITE® | Yes | No | Yes | No | No | No | No | No |<br>| Grand Theft Auto IV | Yes | Yes | Yes | Yes | No | No | Yes | No |<br>| Chivalry: Medieval Warfare | Yes | No | Yes | No | No | No | No | No |<br>| Darkest Dungeon® | Yes | Yes | Yes | No | No | No | Yes | No |</span></div><div style="border:.5px solid #d0d1d8;border-radius:3px;color:#4a4c52;padding:15px;font-family:helveticaneue-light,sans-serif;margin-top:2em;margin-bottom:2em;font-size:18px;height:100%"># List of games<br><br>Name: DOOM<br>Description: Now includes all three premium DLC packs (Unto the Evil, Hell Followed, and Bloodfall), maps, modes, and weapons, as well as all feature updates including Arcade Mode, Photo Mode, and the latest Update 6.66, which brings further multiplayer improvements as well as revamps multiplayer progression.<br><br>Name: This War of Mine<br>Description: In This War Of Mine you do not play as an elite soldier, rather a group of civilians trying to survive in a besieged city; struggling with lack of food, medicine and constant danger from snipers and hostile scavengers. The game provides an experience of war seen from an entirely new angle.<br><br>Name: Saints Row IV<br>Description: The US President must save the Earth from alien overlord Zinyak using an arsenal of superpowers and strange weapons in the wildest open world game ever.<br><br>Name: Divinity: Original Sin 2 - Definitive Edition<br>Description: The eagerly anticipated sequel to the award-winning RPG. Gather your party. Master deep, tactical combat. Join up to 3 other players - but know that only one of you will have the chance to become a God.<br><br>Name: Portal<br>Description: Portal™ is a new single player game from Valve. Set in the mysterious Aperture Science Laboratories, Portal has been called one of the most innovative new games on the horizon and will offer gamers hours of unique gameplay.<br><br># Table of games and their genres<br><br>| Name | Action | RPG | Strategy | Simulation | Puzzle | Casual | Adventure | Platformer |<br>| --- | --- | --- | --- | --- | --- | --- | --- | --- |<span style=background-color:#b9eebc>
&nbsp;<br>| DOOM | X | | | | | | | |<br>| This War of Mine | | X | | | | | | |<br>| Saints Row IV | X | | | | | | | |<br>| Divinity: Original Sin 2 - Definitive Edition | | X | X | | | | | |<br>| Portal | | | | X | X | | | |</span></div><h1 id=limiting-values-in-the-table>Limiting values in the table</h1><p>As you can notice above, the tables in the two examples are not exactly in the same format. In my experiments, I have seen <code>Yes</code> / <code>No</code>, <code>T</code> / <code>F</code>, <code>true</code> / <code>false</code>, <code>+</code> / <code>-</code>, <code>TRUE</code> / <code>FALSE</code>, <code>X</code> / <code>O</code>, <code>X</code> / nothing. Why is this important for us?</p><p>It is time to think about what we are going to do with the responses. Let&rsquo;s remind ourselves that our goal is to kickstart classification. That is, we want to label some new data so that later we can train our own supervised classified. Let&rsquo;s start with the intention to label 200 samples.</p><p>But with a single request to GPT-3 we can only label 5-10 samples (depending on the size of the prompt, we will discuss this below in <a href=#number-of-samples>Number of samples section</a> section). Hence we need to automate the process of making requests and parsing the responses. And the first step is to make sure that the responses are uniform: we want the same type of values in the table, instead of many different ones.</p><p>I&rsquo;ve found that the simplest way to do that is to include the values in the prompt (<span style=background-color:#ffa1a1>
note the change
</span>):</p><div style="border:.5px solid #d0d1d8;border-radius:3px;color:#4a4c52;padding:15px;font-family:helveticaneue-light,sans-serif;margin-top:2em;margin-bottom:2em;font-size:18px;height:100%"># List of games<br><br>Name: DOOM<br>Description: Now includes all three premium DLC packs (Unto the Evil, Hell Followed, and Bloodfall), maps, modes, and weapons, as well as all feature updates including Arcade Mode, Photo Mode, and the latest Update 6.66, which brings further multiplayer improvements as well as revamps multiplayer progression.<br><br>Name: This War of Mine<br>Description: In This War Of Mine you do not play as an elite soldier, rather a group of civilians trying to survive in a besieged city; struggling with lack of food, medicine and constant danger from snipers and hostile scavengers. The game provides an experience of war seen from an entirely new angle.<br><br>Name: Saints Row IV<br>Description: The US President must save the Earth from alien overlord Zinyak using an arsenal of superpowers and strange weapons in the wildest open world game ever.<br><br>Name: Divinity: Original Sin 2 - Definitive Edition<br>Description: The eagerly anticipated sequel to the award-winning RPG. Gather your party. Master deep, tactical combat. Join up to 3 other players - but know that only one of you will have the chance to become a God.<br><br>Name: Portal<br>Description: Portal™ is a new single player game from Valve. Set in the mysterious Aperture Science Laboratories, Portal has been called one of the most innovative new games on the horizon and will offer gamers hours of unique gameplay.<br><br># Table of games and their genres <span style=background-color:#ffa1a1>(TRUE or FALSE)</span><br><br>| Name | Action | RPG | Strategy | Simulation | Puzzle | Casual | Adventure | Platformer |<br>| --- | --- | --- | --- | --- | --- | --- | --- | --- |<span style=background-color:#b9eebc>
&nbsp;<br>| DOOM | TRUE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE |<br>| This War of Mine | FALSE | FALSE | FALSE | TRUE | FALSE | FALSE | FALSE | FALSE |<br>| Saints Row IV | TRUE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE |<br>| Divinity: Original Sin 2 - Definitive Edition | FALSE | TRUE | TRUE | FALSE | FALSE | FALSE | FALSE | FALSE |<br>| Portal | FALSE | FALSE | FALSE | FALSE | TRUE | FALSE | FALSE | FALSE |</span></div><p>In my experiments, this all but ensures that the values in the table will be TRUE or FALSE<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. We will also add some checks in our automation code later to make sure that GPT-3 doesn&rsquo;t generate other values<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>.</p><p>I will hint that there is a better way to ensure the stability of responses, using <code>logit_bias</code>. I may address this at the end of the series, but it is not essential &ndash; it is usually enough to modify the prompt as shown above.</p><h1 id=experimenting-with-the-prompt>Experimenting with the prompt</h1><p>At this point, we&rsquo;re close to fixing our prompt. Of course, the samples will change on every request, but the surrounding will stay the same. This is a good spot to experiment with the prompt a little more.</p><p>In particular, I&rsquo;ve found that thinking about the labels (names of the columns in the table) is very useful. Since we&rsquo;ve not provided any description of the labels, GPT-3 can only go with the names of the labels to infer their meaning. For example, we may have the label &ldquo;Action&rdquo; &ndash; but the word itself has multiple meanings. GPT-3 will consider the context (our prompt mentions games and genres), but we may want to try making it easier for GPT-3 to understand what we want. For example, instead of &ldquo;Action&rdquo;, we can make the label &ldquo;Genre Action&rdquo;. Or even make it more technical, as if it is a dump of the database, e.g. &ldquo;genre_action&rdquo;.</p><style>#callout{background:#f9f9f9;padding:1.5em 1.25em;border-radius:3px;display:flex;flex-direction:row;margin-bottom:20px}#callout-inner{margin-left:1em}@media(max-width:767px){#callout{padding:1.5em .75em 1.5em .6em}#callout-inner{margin-left:.5em}}</style><div id=callout><div>⚠️</div><div id=callout-inner>Before you start experimenting, check the settings of the completion on the right pane in the GPT-3 Playground UI. In particular, set <code>Temperature</code> to 0, <code>Maximum length</code> to something around 200, <code>Top P</code> to 1, <code>Frequency Penalty</code> to 0, <code>Presence Penalty</code> to 0, <code>Best of</code> to 1. I will discuss the settings in the next post.</div></div><p>So what I usually do is pick some samples which I think GPT-3 should be able to classify and some samples which seem difficult for me and try to change the prompt and look at the responses for correctness. In parallel, I am trying to gauge the stability of the responses: how much do they change when I make modifications to the prompt?</p><p>I usually do 3-7 experiments like these. There is space for automation here, but I find this part fun and creative, and eventually not taking too much time.</p><p>Let&rsquo;s try this in practice. First, I change the games a little, picking them such that they span different genres, and try our initial prompt:</p><div style="border:.5px solid #d0d1d8;border-radius:3px;color:#4a4c52;padding:15px;font-family:helveticaneue-light,sans-serif;margin-top:2em;margin-bottom:2em;font-size:18px;height:100%"># List of games<br><br>Name: DOOM<br>Description: Now includes all three premium DLC packs (Unto the Evil, Hell Followed, and Bloodfall), maps, modes, and weapons, as well as all feature updates including Arcade Mode, Photo Mode, and the latest Update 6.66, which brings further multiplayer improvements as well as revamps multiplayer progression.<br><br>Name: This War of Mine<br>Description: In This War Of Mine you do not play as an elite soldier, rather a group of civilians trying to survive in a besieged city; struggling with lack of food, medicine and constant danger from snipers and hostile scavengers. The game provides an experience of war seen from an entirely new angle.<br><br>Name: Divinity: Original Sin 2 - Definitive Edition<br>Description: The eagerly anticipated sequel to the award-winning RPG. Gather your party. Master deep, tactical combat. Join up to 3 other players - but know that only one of you will have the chance to become a God.<br><br>Name: Portal<br>Description: Portal™ is a new single player game from Valve. Set in the mysterious Aperture Science Laboratories, Portal has been called one of the most innovative new games on the horizon and will offer gamers hours of unique gameplay.<br><br>Name: AdVenture Capitalist<br>Description: Welcome, eager young investor, to AdVenture Capitalist! Arguably the world's greatest Capitalism simulator!<br><br># Table of games and their genres (TRUE or FALSE)<br><br>| Name | Action | RPG | Strategy | Simulation | Puzzle | Casual | Adventure | Platformer |<br>| --- | --- | --- | --- | --- | --- | --- | --- | --- |<span style=background-color:#b9eebc>
&nbsp;<br>| DOOM | TRUE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE |<br>| This War of Mine | FALSE | FALSE | FALSE | TRUE | FALSE | FALSE | TRUE | FALSE |<br>| Divinity: Original Sin 2 - Definitive Edition | FALSE | TRUE | TRUE | FALSE | FALSE | FALSE | FALSE | FALSE |<br>| Portal | FALSE | FALSE | FALSE | FALSE | TRUE | FALSE | FALSE | FALSE |<br>| AdVenture Capitalist | FALSE | FALSE | FALSE | TRUE | FALSE | TRUE | FALSE | FALSE |</span></div><p>The result is the following (rendering is for ease of reading):</p><table class="table table-striped table-bordered"><thead><tr><th>Name</th><th>Action</th><th>RPG</th><th>Strategy</th><th>Simulation</th><th>Puzzle</th><th>Casual</th><th>Adventure</th><th>Platformer</th></tr></thead><tbody><tr><td>DOOM</td><td>TRUE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td></tr><tr><td>This War of Mine</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>TRUE</td><td>FALSE</td><td>FALSE</td><td>TRUE</td><td>FALSE</td></tr><tr><td>Divinity: Original Sin 2 - Definitive Edition</td><td>FALSE</td><td>TRUE</td><td>TRUE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td></tr><tr><td>Portal</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>TRUE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td></tr><tr><td>AdVenture Capitalist</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>TRUE</td><td>FALSE</td><td>TRUE</td><td>FALSE</td><td>FALSE</td></tr></tbody></table><p>At a first glance, this is not bad. I&rsquo;d like it to classify Portal as Action and Platformer, but well, Puzzle is already pretty good. Still, I try to change the prompt a little. Remember that there are two main goals here: try to improve the responses and gauge the stability. I change the prompt so that it seems more like a database dump (lowercase labels with <code>snake_case</code>):</p><p><div style="border:.5px solid #d0d1d8;border-radius:3px;color:#4a4c52;padding:15px;font-family:helveticaneue-light,sans-serif;margin-top:2em;margin-bottom:2em;font-size:18px;height:100%"># List of games<br><br>name: DOOM<br>description: Now includes all three premium DLC packs (Unto the Evil, Hell Followed, and Bloodfall), maps, modes, and weapons, as well as all feature updates including Arcade Mode, Photo Mode, and the latest Update 6.66, which brings further multiplayer improvements as well as revamps multiplayer progression.<br><br>name: This War of Mine<br>description: In This War Of Mine you do not play as an elite soldier, rather a group of civilians trying to survive in a besieged city; struggling with lack of food, medicine and constant danger from snipers and hostile scavengers. The game provides an experience of war seen from an entirely new angle.<br><br>name: Divinity: Original Sin 2 - Definitive Edition<br>description: The eagerly anticipated sequel to the award-winning RPG. Gather your party. Master deep, tactical combat. Join up to 3 other players - but know that only one of you will have the chance to become a God.<br><br>name: Portal<br>description: Portal™ is a new single player game from Valve. Set in the mysterious Aperture Science Laboratories, Portal has been called one of the most innovative new games on the horizon and will offer gamers hours of unique gameplay.<br><br>name: AdVenture Capitalist<br>description: Welcome, eager young investor, to AdVenture Capitalist! Arguably the world's greatest Capitalism simulator!<br><br># Table of games and their genres (TRUE or FALSE)<br><br>| name | genre_action | genre_rpg | genre_strategy | genre_simulation | genre_puzzle | genre_casual | genre_adventure | genre_platformer |<br>| --- | --- | --- | --- | --- | --- | --- | --- | --- |<span style=background-color:#b9eebc>
&nbsp;<br>| DOOM | TRUE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE |<br>| This War of Mine | FALSE | FALSE | FALSE | TRUE | FALSE | FALSE | TRUE | FALSE |<br>| Divinity: Original Sin 2 - Definitive Edition | FALSE | TRUE | TRUE | FALSE | FALSE | FALSE | FALSE | FALSE |<br>| Portal | FALSE | FALSE | FALSE | FALSE | TRUE | FALSE | FALSE | FALSE |<br>| AdVenture Capitalist | FALSE | FALSE | FALSE | TRUE | FALSE | TRUE | FALSE | FALSE |</span></div><table class="table table-striped table-bordered"><thead><tr><th>name</th><th>genre_action</th><th>genre_rpg</th><th>genre_strategy</th><th>genre_simulation</th><th>genre_puzzle</th><th>genre_casual</th><th>genre_adventure</th><th>genre_platformer</th></tr></thead><tbody><tr><td>DOOM</td><td>TRUE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td></tr><tr><td>This War of Mine</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>TRUE</td><td>FALSE</td><td>FALSE</td><td>TRUE</td><td>FALSE</td></tr><tr><td>Divinity: Original Sin 2 - Definitive Edition</td><td>FALSE</td><td>TRUE</td><td>TRUE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td></tr><tr><td>Portal</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>TRUE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td></tr><tr><td>AdVenture Capitalist</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>TRUE</td><td>FALSE</td><td>TRUE</td><td>FALSE</td><td>FALSE</td></tr></tbody></table></p><p>Aaaaand nothing has changed. This is good news for stability, and bad for improving our labels. Here I get another idea: what if I add price to the input data? Since platformers are usually cheaper than AAA games, maybe this would help.</p><div style="border:.5px solid #d0d1d8;border-radius:3px;color:#4a4c52;padding:15px;font-family:helveticaneue-light,sans-serif;margin-top:2em;margin-bottom:2em;font-size:18px;height:100%"># List of steam games<br><br>name: DOOM<br>description: Now includes all three premium DLC packs (Unto the Evil, Hell Followed, and Bloodfall), maps, modes, and weapons, as well as all feature updates including Arcade Mode, Photo Mode, and the latest Update 6.66, which brings further multiplayer improvements as well as revamps multiplayer progression.<br>price: $19.99<br><br>name: This War of Mine<br>description: In This War Of Mine you do not play as an elite soldier, rather a group of civilians trying to survive in a besieged city; struggling with lack of food, medicine and constant danger from snipers and hostile scavengers. The game provides an experience of war seen from an entirely new angle.<br>price: $19.99<br><br>name: Divinity: Original Sin 2 - Definitive Edition<br>description: The eagerly anticipated sequel to the award-winning RPG. Gather your party. Master deep, tactical combat. Join up to 3 other players - but know that only one of you will have the chance to become a God.<br>price: $44.99<br><br>name: Portal<br>description: Portal™ is a new single player game from Valve. Set in the mysterious Aperture Science Laboratories, Portal has been called one of the most innovative new games on the horizon and will offer gamers hours of unique gameplay.<br>price: $9.99<br><br>name: AdVenture Capitalist<br>description: Welcome, eager young investor, to AdVenture Capitalist! Arguably the world's greatest Capitalism simulator!<br>price: Free to Play<br><br># Table of games and their genres (TRUE or FALSE)<br><br>| name | action | rpg | strategy | simulation | puzzle | casual | adventure | platformer |<br>| --- | --- | --- | --- | --- | --- | --- | --- | --- |<span style=background-color:#b9eebc>
&nbsp;<br>| DOOM | TRUE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE | FALSE |<br>| This War of Mine | FALSE | FALSE | FALSE | TRUE | FALSE | FALSE | TRUE | FALSE |<br>| Divinity: Original Sin 2 - Definitive Edition | FALSE | TRUE | TRUE | FALSE | FALSE | FALSE | FALSE | FALSE |<br>| Portal | FALSE | FALSE | FALSE | FALSE | TRUE | FALSE | FALSE | FALSE |<br>| AdVenture Capitalist | FALSE | FALSE | FALSE | TRUE | FALSE | TRUE | FALSE | FALSE |</span></div><table class="table table-striped table-bordered"><thead><tr><th>name</th><th>action</th><th>rpg</th><th>strategy</th><th>simulation</th><th>puzzle</th><th>casual</th><th>adventure</th><th>platformer</th></tr></thead><tbody><tr><td>DOOM</td><td>TRUE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td></tr><tr><td>This War of Mine</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>TRUE</td><td>FALSE</td><td>FALSE</td><td>TRUE</td><td>FALSE</td></tr><tr><td>Divinity: Original Sin 2 - Definitive Edition</td><td>FALSE</td><td>TRUE</td><td>TRUE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td></tr><tr><td>Portal</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>TRUE</td><td>FALSE</td><td>FALSE</td><td>FALSE</td></tr><tr><td>AdVenture Capitalist</td><td>FALSE</td><td>FALSE</td><td>FALSE</td><td>TRUE</td><td>FALSE</td><td>TRUE</td><td>FALSE</td><td>FALSE</td></tr></tbody></table><p>Still, there are no changes. At this point, I am inclined to stop. The responses are rather stable, and the labels, while not perfect, are pretty good.</p><h1 id=limitations>Limitations</h1><p>Let&rsquo;s talk a little about the limitations of this approach before we go further.</p><h2 id=stability>Stability of responses</h2><p>We have to come to terms with the fact that everything influences GPT-3 response to a certain extent. This is inherent to the nature of the approach. Anything can change the probabilities of the responses: the wording of the prompt, a change in capitalization, a change in the order of the labels and samples<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>. We&rsquo;re hoping that the responses are stable enough that we don&rsquo;t have to think too much about it.</p><p>That said, in manual labelling, there is the same issue. Different people will label samples differently, people are also influenced by instructions and wording, by cognitive biases, such as the <a href=https://en.wikipedia.org/wiki/Anchoring_(cognitive_bias)>anchoring effect</a>. So in reality it is not so different.</p><h2 id=truthfulness-and-typos>Truthfulness and typos</h2><p>How correct are the responses of the model? There is a whole area of research dedicated to Large Language Model truthfulness (see <a href=https://www.alignmentforum.org/posts/PF58wEdztZFX2dSue/how-truthful-is-gpt-3-a-benchmark-for-language-models>this</a> for example). Since the training set contains a lot of information from the web, nothing guarantees that it will be correct. In some ways, we are relying on the fact that the training set contains much more correct information than false.</p><p>However, there is another fun point, relating to the stability of responses. Depending on the problem, while GPT-3 may be able to solve it in principle, it may &ldquo;think&rdquo; that our prompt implies some degree of incorrectness. How&rsquo;s that?</p><p>Think about an example: we try to generate responses to a math test. If our prompt implies that this is the control version of the test, it will tend to be correct. But if the prompt implies that this is a response of a student to the test, it may be slightly incorrect.</p><p>How does it relate to our problem? Well, if you make a typo somewhere in your prompt, while GPT-3 will for sure understand what you meant, it might &ldquo;think&rdquo; that the text it is generating is not, let&rsquo;s say, &ldquo;written by a professional&rdquo;. This could lead to the response also being somewhat mistaken. So check your prompt several times for typos and wording.</p><h2 id=number-of-samples>Number of samples</h2><p>How many samples can we insert in one request? GPT-3 has a hard limit on the total number of tokens (prompt + generations) &ndash; <strong>2048</strong> tokens<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>. Each token is 4 characters on average, so we can say that in total we can use around 8400 characters.</p><p>Depending on the size of each sample, we can determine the maximum number of samples to be put in on request. However, since GPT-3 charges per token, we&rsquo;re not saving a lot by cramming as many samples as possible in each request. I prefer to stay way below the limit, usually at 5-7 samples per request.</p><h1 id=whats-next>What&rsquo;s next</h1><p>In this post, we&rsquo;ve formatted the responses as Markdown tables, limited responses to TRUE / FALSE to improve stability, experimented with prompts and discussed some limitations and considerations of this approach.</p><p>In the <a href=https://antopolskiy.github.io/post/gpt3_3/>next post</a>, we will write Python code to automate requests and parse the responses to get a set of labels for each sample.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>I use TRUE and FALSE because it is usually how boolean types are written in SQL databases. It is as if I try to convince GPT-3 that the table is a dump of a SQL table.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>These types of errors are usually called &ldquo;out-of-bound response&rdquo;. This is an umbrella term, which means that the classifier generated something unforeseen as a label.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>It would be an interesting project to test the stability of the responses for some of these factors properly.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>Actually, the newest models are supposed to support 4096 tokens, according to the <a href=https://beta.openai.com/docs/api-reference/completions/create#completions/create-max_tokens>documentation</a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><h4 class=page-header>Related</h4><div class=item><h4><a href=/post/gpt3_4/>Kickstart text classification with GPT-3, part 4</a></h4><h5>January 7, 2023</h5><a href=https://antopolskiy.github.io/tags/ml><kbd class=item-tag>ml</kbd></a>
<a href=https://antopolskiy.github.io/tags/nlp><kbd class=item-tag>nlp</kbd></a>
<a href=https://antopolskiy.github.io/tags/gpt3><kbd class=item-tag>gpt3</kbd></a></div><div class=item><h4><a href=/post/gpt3_3/>Kickstart text classification with GPT-3, part 3</a></h4><h5>November 20, 2022</h5><a href=https://antopolskiy.github.io/tags/ml><kbd class=item-tag>ml</kbd></a>
<a href=https://antopolskiy.github.io/tags/nlp><kbd class=item-tag>nlp</kbd></a>
<a href=https://antopolskiy.github.io/tags/gpt3><kbd class=item-tag>gpt3</kbd></a></div><div class=item><h4><a href=/post/gpt3_1/>Kickstart text classification with GPT-3, part 1</a></h4><h5>October 1, 2022</h5><a href=https://antopolskiy.github.io/tags/ml><kbd class=item-tag>ml</kbd></a>
<a href=https://antopolskiy.github.io/tags/nlp><kbd class=item-tag>nlp</kbd></a>
<a href=https://antopolskiy.github.io/tags/gpt3><kbd class=item-tag>gpt3</kbd></a></div><h4 class=page-header>Comments</h4><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//https-antopolskiy-github-io.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></main><footer><p class="copyright text-muted">© Sergey Antopolskiy, 2024</p></footer></body></html>